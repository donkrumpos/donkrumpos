---
import Base from '../../layouts/Base.astro';
import ProjectCard from '../../components/ProjectCard.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects', ({ data }) => !data.draft))
  .sort((a, b) => {
    if (a.data.order !== undefined && b.data.order !== undefined) {
      return a.data.order - b.data.order;
    }
    if (a.data.order !== undefined) return -1;
    if (b.data.order !== undefined) return 1;
    return b.data.date.getTime() - a.data.date.getTime();
  });

// Group by category
const categories = ['UI/UX', 'Branding', 'Design Systems', 'Print'] as const;
const grouped = categories
  .map(cat => ({
    name: cat,
    projects: projects.filter(p => p.data.category === cat),
  }))
  .filter(g => g.projects.length > 0);
---

<Base title="Work â€” Don Krumpos">
  <div class="page-header">
    <h1 class="page-header__title">Work</h1>
    <p class="page-header__subtitle">Selected projects across UI/UX, branding, design systems, and print.</p>
  </div>

  {grouped.map(group => (
    <section class="work-section">
      <h2 class="work-section__title">{group.name}</h2>
      <div class="project-grid">
        {group.projects.map(project => (
          <ProjectCard
            title={project.data.title}
            description={project.data.description}
            thumbnail={project.data.thumbnail}
            slug={project.id}
            category={project.data.category}
            client={project.data.client}
          />
        ))}
      </div>
    </section>
  ))}
</Base>
